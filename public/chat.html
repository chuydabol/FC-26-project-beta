<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>Chat</title>
  <style>
    html,body{
      margin:0;
      padding:0;
      min-height:100%;
      background:radial-gradient(circle at center, #0a0f1c, #000000);
      background-size:cover;
      background-attachment:fixed;
      background-color:#000;
      overflow-x:hidden;
    }
    body{
      font:14px Arial;
      color:#fff;
      min-height:100vh;
      padding-top:env(safe-area-inset-top);
      padding-bottom:env(safe-area-inset-bottom);
    }
    header{padding:12px;background:#111}
    main{padding:12px;max-width:800px;margin:auto}
    #log{height:60vh;overflow:auto;border:1px solid #333;padding:8px;background:#0b0b0b}
    input,button{padding:10px;border-radius:8px;border:1px solid #333;background:#1a1a1a;color:#fff}
    button{cursor:pointer}
  </style>
</head>
<body>
  <header><h3 id="title">Chat</h3></header>
  <main>
    <div id="log"></div>
    <div style="display:flex;gap:8px;margin-top:8px">
      <input id="msg" placeholder="Type a message…" style="flex:1">
      <button id="send">Send</button>
    </div>
  </main>
  <script>
const params = new URLSearchParams(location.search);
const room = params.get('room') || 'lobby';
document.getElementById('title').textContent = `Chat — ${room}`;
const KEY = `chat:${room}`;
const log = document.getElementById('log');
const msg = document.getElementById('msg');

function load(){ (JSON.parse(localStorage.getItem(KEY)||'[]')).forEach(add); }
function add({t, text}){ const p=document.createElement('div'); p.textContent=`[${new Date(t).toLocaleTimeString()}] ${text}`; log.appendChild(p); log.scrollTop=log.scrollHeight; }
function save(text){ const arr=JSON.parse(localStorage.getItem(KEY)||'[]'); arr.push({t:Date.now(), text}); localStorage.setItem(KEY, JSON.stringify(arr)); }

document.getElementById('send').onclick = ()=>{
  const text = msg.value.trim(); if(!text) return;
  save(text); add({t:Date.now(), text}); msg.value='';
};
load();
  </script>
</body>
</html>

